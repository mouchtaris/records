case class Op(v: String) {
def letter(o: Op) = Op("["+o.v+v+"]")
def |(o: Op) = Op("["+o.v+v+"]")
def ^(o: Op) = Op("["+o.v+v+"]")
def &(o: Op) = Op("["+o.v+v+"]")
def <(o: Op) = Op("["+o.v+v+"]")
def >(o: Op) = Op("["+o.v+v+"]")
def !(o: Op) = Op("["+o.v+v+"]")
def +(o: Op) = Op("["+o.v+v+"]")
def -(o: Op) = Op("["+o.v+v+"]")
def *(o: Op) = Op("["+o.v+v+"]")
def /(o: Op) = Op("["+o.v+v+"]")
def %(o: Op) = Op("["+o.v+v+"]")
def ?(o: Op) = Op("["+o.v+v+"]")
def =?(o: Op) = Op("["+o.v+v+"]")
def :?(o: Op) = Op("["+o.v+v+"]")
}
val comps = Map[(String, String), Boolean](("letter","letter") -> (Op(".") letter Op(".") letter Op(".")).v.startsWith("[["),
("letter","|") -> (Op(".") letter Op(".") | Op(".")).v.startsWith("[["),
("letter","^") -> (Op(".") letter Op(".") ^ Op(".")).v.startsWith("[["),
("letter","&") -> (Op(".") letter Op(".") & Op(".")).v.startsWith("[["),
("letter","<") -> (Op(".") letter Op(".") < Op(".")).v.startsWith("[["),
("letter",">") -> (Op(".") letter Op(".") > Op(".")).v.startsWith("[["),
("letter","!") -> (Op(".") letter Op(".") ! Op(".")).v.startsWith("[["),
("letter","+") -> (Op(".") letter Op(".") + Op(".")).v.startsWith("[["),
("letter","-") -> (Op(".") letter Op(".") - Op(".")).v.startsWith("[["),
("letter","*") -> (Op(".") letter Op(".") * Op(".")).v.startsWith("[["),
("letter","/") -> (Op(".") letter Op(".") / Op(".")).v.startsWith("[["),
("letter","%") -> (Op(".") letter Op(".") % Op(".")).v.startsWith("[["),
("letter","?") -> (Op(".") letter Op(".") ? Op(".")).v.startsWith("[["),
("letter","=?") -> (Op(".") letter Op(".") =? Op(".")).v.startsWith("[["),
("letter",":?") -> (Op(".") letter Op(".") :? Op(".")).v.startsWith("[["),
("|","letter") -> (Op(".") | Op(".") letter Op(".")).v.startsWith("[["),
("|","|") -> (Op(".") | Op(".") | Op(".")).v.startsWith("[["),
("|","^") -> (Op(".") | Op(".") ^ Op(".")).v.startsWith("[["),
("|","&") -> (Op(".") | Op(".") & Op(".")).v.startsWith("[["),
("|","<") -> (Op(".") | Op(".") < Op(".")).v.startsWith("[["),
("|",">") -> (Op(".") | Op(".") > Op(".")).v.startsWith("[["),
("|","!") -> (Op(".") | Op(".") ! Op(".")).v.startsWith("[["),
("|","+") -> (Op(".") | Op(".") + Op(".")).v.startsWith("[["),
("|","-") -> (Op(".") | Op(".") - Op(".")).v.startsWith("[["),
("|","*") -> (Op(".") | Op(".") * Op(".")).v.startsWith("[["),
("|","/") -> (Op(".") | Op(".") / Op(".")).v.startsWith("[["),
("|","%") -> (Op(".") | Op(".") % Op(".")).v.startsWith("[["),
("|","?") -> (Op(".") | Op(".") ? Op(".")).v.startsWith("[["),
("|","=?") -> (Op(".") | Op(".") =? Op(".")).v.startsWith("[["),
("|",":?") -> (Op(".") | Op(".") :? Op(".")).v.startsWith("[["),
("^","letter") -> (Op(".") ^ Op(".") letter Op(".")).v.startsWith("[["),
("^","|") -> (Op(".") ^ Op(".") | Op(".")).v.startsWith("[["),
("^","^") -> (Op(".") ^ Op(".") ^ Op(".")).v.startsWith("[["),
("^","&") -> (Op(".") ^ Op(".") & Op(".")).v.startsWith("[["),
("^","<") -> (Op(".") ^ Op(".") < Op(".")).v.startsWith("[["),
("^",">") -> (Op(".") ^ Op(".") > Op(".")).v.startsWith("[["),
("^","!") -> (Op(".") ^ Op(".") ! Op(".")).v.startsWith("[["),
("^","+") -> (Op(".") ^ Op(".") + Op(".")).v.startsWith("[["),
("^","-") -> (Op(".") ^ Op(".") - Op(".")).v.startsWith("[["),
("^","*") -> (Op(".") ^ Op(".") * Op(".")).v.startsWith("[["),
("^","/") -> (Op(".") ^ Op(".") / Op(".")).v.startsWith("[["),
("^","%") -> (Op(".") ^ Op(".") % Op(".")).v.startsWith("[["),
("^","?") -> (Op(".") ^ Op(".") ? Op(".")).v.startsWith("[["),
("^","=?") -> (Op(".") ^ Op(".") =? Op(".")).v.startsWith("[["),
("^",":?") -> (Op(".") ^ Op(".") :? Op(".")).v.startsWith("[["),
("&","letter") -> (Op(".") & Op(".") letter Op(".")).v.startsWith("[["),
("&","|") -> (Op(".") & Op(".") | Op(".")).v.startsWith("[["),
("&","^") -> (Op(".") & Op(".") ^ Op(".")).v.startsWith("[["),
("&","&") -> (Op(".") & Op(".") & Op(".")).v.startsWith("[["),
("&","<") -> (Op(".") & Op(".") < Op(".")).v.startsWith("[["),
("&",">") -> (Op(".") & Op(".") > Op(".")).v.startsWith("[["),
("&","!") -> (Op(".") & Op(".") ! Op(".")).v.startsWith("[["),
("&","+") -> (Op(".") & Op(".") + Op(".")).v.startsWith("[["),
("&","-") -> (Op(".") & Op(".") - Op(".")).v.startsWith("[["),
("&","*") -> (Op(".") & Op(".") * Op(".")).v.startsWith("[["),
("&","/") -> (Op(".") & Op(".") / Op(".")).v.startsWith("[["),
("&","%") -> (Op(".") & Op(".") % Op(".")).v.startsWith("[["),
("&","?") -> (Op(".") & Op(".") ? Op(".")).v.startsWith("[["),
("&","=?") -> (Op(".") & Op(".") =? Op(".")).v.startsWith("[["),
("&",":?") -> (Op(".") & Op(".") :? Op(".")).v.startsWith("[["),
("<","letter") -> (Op(".") < Op(".") letter Op(".")).v.startsWith("[["),
("<","|") -> (Op(".") < Op(".") | Op(".")).v.startsWith("[["),
("<","^") -> (Op(".") < Op(".") ^ Op(".")).v.startsWith("[["),
("<","&") -> (Op(".") < Op(".") & Op(".")).v.startsWith("[["),
("<","<") -> (Op(".") < Op(".") < Op(".")).v.startsWith("[["),
("<",">") -> (Op(".") < Op(".") > Op(".")).v.startsWith("[["),
("<","!") -> (Op(".") < Op(".") ! Op(".")).v.startsWith("[["),
("<","+") -> (Op(".") < Op(".") + Op(".")).v.startsWith("[["),
("<","-") -> (Op(".") < Op(".") - Op(".")).v.startsWith("[["),
("<","*") -> (Op(".") < Op(".") * Op(".")).v.startsWith("[["),
("<","/") -> (Op(".") < Op(".") / Op(".")).v.startsWith("[["),
("<","%") -> (Op(".") < Op(".") % Op(".")).v.startsWith("[["),
("<","?") -> (Op(".") < Op(".") ? Op(".")).v.startsWith("[["),
("<","=?") -> (Op(".") < Op(".") =? Op(".")).v.startsWith("[["),
("<",":?") -> (Op(".") < Op(".") :? Op(".")).v.startsWith("[["),
(">","letter") -> (Op(".") > Op(".") letter Op(".")).v.startsWith("[["),
(">","|") -> (Op(".") > Op(".") | Op(".")).v.startsWith("[["),
(">","^") -> (Op(".") > Op(".") ^ Op(".")).v.startsWith("[["),
(">","&") -> (Op(".") > Op(".") & Op(".")).v.startsWith("[["),
(">","<") -> (Op(".") > Op(".") < Op(".")).v.startsWith("[["),
(">",">") -> (Op(".") > Op(".") > Op(".")).v.startsWith("[["),
(">","!") -> (Op(".") > Op(".") ! Op(".")).v.startsWith("[["),
(">","+") -> (Op(".") > Op(".") + Op(".")).v.startsWith("[["),
(">","-") -> (Op(".") > Op(".") - Op(".")).v.startsWith("[["),
(">","*") -> (Op(".") > Op(".") * Op(".")).v.startsWith("[["),
(">","/") -> (Op(".") > Op(".") / Op(".")).v.startsWith("[["),
(">","%") -> (Op(".") > Op(".") % Op(".")).v.startsWith("[["),
(">","?") -> (Op(".") > Op(".") ? Op(".")).v.startsWith("[["),
(">","=?") -> (Op(".") > Op(".") =? Op(".")).v.startsWith("[["),
(">",":?") -> (Op(".") > Op(".") :? Op(".")).v.startsWith("[["),
("!","letter") -> (Op(".") ! Op(".") letter Op(".")).v.startsWith("[["),
("!","|") -> (Op(".") ! Op(".") | Op(".")).v.startsWith("[["),
("!","^") -> (Op(".") ! Op(".") ^ Op(".")).v.startsWith("[["),
("!","&") -> (Op(".") ! Op(".") & Op(".")).v.startsWith("[["),
("!","<") -> (Op(".") ! Op(".") < Op(".")).v.startsWith("[["),
("!",">") -> (Op(".") ! Op(".") > Op(".")).v.startsWith("[["),
("!","!") -> (Op(".") ! Op(".") ! Op(".")).v.startsWith("[["),
("!","+") -> (Op(".") ! Op(".") + Op(".")).v.startsWith("[["),
("!","-") -> (Op(".") ! Op(".") - Op(".")).v.startsWith("[["),
("!","*") -> (Op(".") ! Op(".") * Op(".")).v.startsWith("[["),
("!","/") -> (Op(".") ! Op(".") / Op(".")).v.startsWith("[["),
("!","%") -> (Op(".") ! Op(".") % Op(".")).v.startsWith("[["),
("!","?") -> (Op(".") ! Op(".") ? Op(".")).v.startsWith("[["),
("!","=?") -> (Op(".") ! Op(".") =? Op(".")).v.startsWith("[["),
("!",":?") -> (Op(".") ! Op(".") :? Op(".")).v.startsWith("[["),
("+","letter") -> (Op(".") + Op(".") letter Op(".")).v.startsWith("[["),
("+","|") -> (Op(".") + Op(".") | Op(".")).v.startsWith("[["),
("+","^") -> (Op(".") + Op(".") ^ Op(".")).v.startsWith("[["),
("+","&") -> (Op(".") + Op(".") & Op(".")).v.startsWith("[["),
("+","<") -> (Op(".") + Op(".") < Op(".")).v.startsWith("[["),
("+",">") -> (Op(".") + Op(".") > Op(".")).v.startsWith("[["),
("+","!") -> (Op(".") + Op(".") ! Op(".")).v.startsWith("[["),
("+","+") -> (Op(".") + Op(".") + Op(".")).v.startsWith("[["),
("+","-") -> (Op(".") + Op(".") - Op(".")).v.startsWith("[["),
("+","*") -> (Op(".") + Op(".") * Op(".")).v.startsWith("[["),
("+","/") -> (Op(".") + Op(".") / Op(".")).v.startsWith("[["),
("+","%") -> (Op(".") + Op(".") % Op(".")).v.startsWith("[["),
("+","?") -> (Op(".") + Op(".") ? Op(".")).v.startsWith("[["),
("+","=?") -> (Op(".") + Op(".") =? Op(".")).v.startsWith("[["),
("+",":?") -> (Op(".") + Op(".") :? Op(".")).v.startsWith("[["),
("-","letter") -> (Op(".") - Op(".") letter Op(".")).v.startsWith("[["),
("-","|") -> (Op(".") - Op(".") | Op(".")).v.startsWith("[["),
("-","^") -> (Op(".") - Op(".") ^ Op(".")).v.startsWith("[["),
("-","&") -> (Op(".") - Op(".") & Op(".")).v.startsWith("[["),
("-","<") -> (Op(".") - Op(".") < Op(".")).v.startsWith("[["),
("-",">") -> (Op(".") - Op(".") > Op(".")).v.startsWith("[["),
("-","!") -> (Op(".") - Op(".") ! Op(".")).v.startsWith("[["),
("-","+") -> (Op(".") - Op(".") + Op(".")).v.startsWith("[["),
("-","-") -> (Op(".") - Op(".") - Op(".")).v.startsWith("[["),
("-","*") -> (Op(".") - Op(".") * Op(".")).v.startsWith("[["),
("-","/") -> (Op(".") - Op(".") / Op(".")).v.startsWith("[["),
("-","%") -> (Op(".") - Op(".") % Op(".")).v.startsWith("[["),
("-","?") -> (Op(".") - Op(".") ? Op(".")).v.startsWith("[["),
("-","=?") -> (Op(".") - Op(".") =? Op(".")).v.startsWith("[["),
("-",":?") -> (Op(".") - Op(".") :? Op(".")).v.startsWith("[["),
("*","letter") -> (Op(".") * Op(".") letter Op(".")).v.startsWith("[["),
("*","|") -> (Op(".") * Op(".") | Op(".")).v.startsWith("[["),
("*","^") -> (Op(".") * Op(".") ^ Op(".")).v.startsWith("[["),
("*","&") -> (Op(".") * Op(".") & Op(".")).v.startsWith("[["),
("*","<") -> (Op(".") * Op(".") < Op(".")).v.startsWith("[["),
("*",">") -> (Op(".") * Op(".") > Op(".")).v.startsWith("[["),
("*","!") -> (Op(".") * Op(".") ! Op(".")).v.startsWith("[["),
("*","+") -> (Op(".") * Op(".") + Op(".")).v.startsWith("[["),
("*","-") -> (Op(".") * Op(".") - Op(".")).v.startsWith("[["),
("*","*") -> (Op(".") * Op(".") * Op(".")).v.startsWith("[["),
("*","/") -> (Op(".") * Op(".") / Op(".")).v.startsWith("[["),
("*","%") -> (Op(".") * Op(".") % Op(".")).v.startsWith("[["),
("*","?") -> (Op(".") * Op(".") ? Op(".")).v.startsWith("[["),
("*","=?") -> (Op(".") * Op(".") =? Op(".")).v.startsWith("[["),
("*",":?") -> (Op(".") * Op(".") :? Op(".")).v.startsWith("[["),
("/","letter") -> (Op(".") / Op(".") letter Op(".")).v.startsWith("[["),
("/","|") -> (Op(".") / Op(".") | Op(".")).v.startsWith("[["),
("/","^") -> (Op(".") / Op(".") ^ Op(".")).v.startsWith("[["),
("/","&") -> (Op(".") / Op(".") & Op(".")).v.startsWith("[["),
("/","<") -> (Op(".") / Op(".") < Op(".")).v.startsWith("[["),
("/",">") -> (Op(".") / Op(".") > Op(".")).v.startsWith("[["),
("/","!") -> (Op(".") / Op(".") ! Op(".")).v.startsWith("[["),
("/","+") -> (Op(".") / Op(".") + Op(".")).v.startsWith("[["),
("/","-") -> (Op(".") / Op(".") - Op(".")).v.startsWith("[["),
("/","*") -> (Op(".") / Op(".") * Op(".")).v.startsWith("[["),
("/","/") -> (Op(".") / Op(".") / Op(".")).v.startsWith("[["),
("/","%") -> (Op(".") / Op(".") % Op(".")).v.startsWith("[["),
("/","?") -> (Op(".") / Op(".") ? Op(".")).v.startsWith("[["),
("/","=?") -> (Op(".") / Op(".") =? Op(".")).v.startsWith("[["),
("/",":?") -> (Op(".") / Op(".") :? Op(".")).v.startsWith("[["),
("%","letter") -> (Op(".") % Op(".") letter Op(".")).v.startsWith("[["),
("%","|") -> (Op(".") % Op(".") | Op(".")).v.startsWith("[["),
("%","^") -> (Op(".") % Op(".") ^ Op(".")).v.startsWith("[["),
("%","&") -> (Op(".") % Op(".") & Op(".")).v.startsWith("[["),
("%","<") -> (Op(".") % Op(".") < Op(".")).v.startsWith("[["),
("%",">") -> (Op(".") % Op(".") > Op(".")).v.startsWith("[["),
("%","!") -> (Op(".") % Op(".") ! Op(".")).v.startsWith("[["),
("%","+") -> (Op(".") % Op(".") + Op(".")).v.startsWith("[["),
("%","-") -> (Op(".") % Op(".") - Op(".")).v.startsWith("[["),
("%","*") -> (Op(".") % Op(".") * Op(".")).v.startsWith("[["),
("%","/") -> (Op(".") % Op(".") / Op(".")).v.startsWith("[["),
("%","%") -> (Op(".") % Op(".") % Op(".")).v.startsWith("[["),
("%","?") -> (Op(".") % Op(".") ? Op(".")).v.startsWith("[["),
("%","=?") -> (Op(".") % Op(".") =? Op(".")).v.startsWith("[["),
("%",":?") -> (Op(".") % Op(".") :? Op(".")).v.startsWith("[["),
("?","letter") -> (Op(".") ? Op(".") letter Op(".")).v.startsWith("[["),
("?","|") -> (Op(".") ? Op(".") | Op(".")).v.startsWith("[["),
("?","^") -> (Op(".") ? Op(".") ^ Op(".")).v.startsWith("[["),
("?","&") -> (Op(".") ? Op(".") & Op(".")).v.startsWith("[["),
("?","<") -> (Op(".") ? Op(".") < Op(".")).v.startsWith("[["),
("?",">") -> (Op(".") ? Op(".") > Op(".")).v.startsWith("[["),
("?","!") -> (Op(".") ? Op(".") ! Op(".")).v.startsWith("[["),
("?","+") -> (Op(".") ? Op(".") + Op(".")).v.startsWith("[["),
("?","-") -> (Op(".") ? Op(".") - Op(".")).v.startsWith("[["),
("?","*") -> (Op(".") ? Op(".") * Op(".")).v.startsWith("[["),
("?","/") -> (Op(".") ? Op(".") / Op(".")).v.startsWith("[["),
("?","%") -> (Op(".") ? Op(".") % Op(".")).v.startsWith("[["),
("?","?") -> (Op(".") ? Op(".") ? Op(".")).v.startsWith("[["),
("?","=?") -> (Op(".") ? Op(".") =? Op(".")).v.startsWith("[["),
("?",":?") -> (Op(".") ? Op(".") :? Op(".")).v.startsWith("[["),
("=?","letter") -> (Op(".") =? Op(".") letter Op(".")).v.startsWith("[["),
("=?","|") -> (Op(".") =? Op(".") | Op(".")).v.startsWith("[["),
("=?","^") -> (Op(".") =? Op(".") ^ Op(".")).v.startsWith("[["),
("=?","&") -> (Op(".") =? Op(".") & Op(".")).v.startsWith("[["),
("=?","<") -> (Op(".") =? Op(".") < Op(".")).v.startsWith("[["),
("=?",">") -> (Op(".") =? Op(".") > Op(".")).v.startsWith("[["),
("=?","!") -> (Op(".") =? Op(".") ! Op(".")).v.startsWith("[["),
("=?","+") -> (Op(".") =? Op(".") + Op(".")).v.startsWith("[["),
("=?","-") -> (Op(".") =? Op(".") - Op(".")).v.startsWith("[["),
("=?","*") -> (Op(".") =? Op(".") * Op(".")).v.startsWith("[["),
("=?","/") -> (Op(".") =? Op(".") / Op(".")).v.startsWith("[["),
("=?","%") -> (Op(".") =? Op(".") % Op(".")).v.startsWith("[["),
("=?","?") -> (Op(".") =? Op(".") ? Op(".")).v.startsWith("[["),
("=?","=?") -> (Op(".") =? Op(".") =? Op(".")).v.startsWith("[["),
("=?",":?") -> (Op(".") =? Op(".") :? Op(".")).v.startsWith("[["),
(":?","letter") -> (Op(".") :? Op(".") letter Op(".")).v.startsWith("[["),
(":?","|") -> (Op(".") :? Op(".") | Op(".")).v.startsWith("[["),
(":?","^") -> (Op(".") :? Op(".") ^ Op(".")).v.startsWith("[["),
(":?","&") -> (Op(".") :? Op(".") & Op(".")).v.startsWith("[["),
(":?","<") -> (Op(".") :? Op(".") < Op(".")).v.startsWith("[["),
(":?",">") -> (Op(".") :? Op(".") > Op(".")).v.startsWith("[["),
(":?","!") -> (Op(".") :? Op(".") ! Op(".")).v.startsWith("[["),
(":?","+") -> (Op(".") :? Op(".") + Op(".")).v.startsWith("[["),
(":?","-") -> (Op(".") :? Op(".") - Op(".")).v.startsWith("[["),
(":?","*") -> (Op(".") :? Op(".") * Op(".")).v.startsWith("[["),
(":?","/") -> (Op(".") :? Op(".") / Op(".")).v.startsWith("[["),
(":?","%") -> (Op(".") :? Op(".") % Op(".")).v.startsWith("[["),
(":?","?") -> (Op(".") :? Op(".") ? Op(".")).v.startsWith("[["),
(":?","=?") -> (Op(".") :? Op(".") =? Op(".")).v.startsWith("[["),
(":?",":?") -> (Op(".") :? Op(".") :? Op(".")).v.startsWith("[["))
